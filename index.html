<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lucky Slots</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bangers&amp;family=Outfit:wght@400;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    
    .font-bangers {
      font-family: 'Bangers', cursive;
    }
    
    .font-outfit {
      font-family: 'Outfit', sans-serif;
    }
    
    @keyframes spin {
      0% { transform: translateY(0); }
      100% { transform: translateY(-100%); }
    }
    
    @keyframes bounce-win {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    @keyframes glow-pulse {
      0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
      50% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.8); }
    }
    
    @keyframes coin-fall {
      0% { transform: translateY(-20px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100px) rotate(360deg); opacity: 0; }
    }
    
    @keyframes pulse-glow {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .reel-container {
      overflow: hidden;
      height: 100px;
    }
    
    .reel {
      transition: transform 0.1s ease-out;
    }
    
    .spinning .reel {
      animation: spin 0.1s linear infinite;
    }
    
    .win-animation {
      animation: bounce-win 0.5s ease-in-out 3;
    }
    
    .jackpot-glow {
      animation: glow-pulse 1s ease-in-out infinite;
    }
    
    .coin {
      animation: coin-fall 1s ease-in forwards;
    }
    
    .slot-machine {
      background: linear-gradient(145deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    }
    
    .ultimate-win {
      animation: pulse-glow 0.5s ease-in-out infinite;
    }
    
    .modal-overlay {
      display: flex;
      align-items: center;
      justify-content: center;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full font-outfit">
  <div id="app" class="h-full w-full overflow-auto" style="background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);">
   <div class="min-h-full flex flex-col items-center justify-center p-4"><!-- Coin explosion container -->
    <div id="coin-container" class="fixed inset-0 pointer-events-none z-50 overflow-hidden"></div><!-- Win Modal -->
    <div id="win-modal" class="hidden fixed inset-0 z-50 modal-overlay" style="background: rgba(0, 0, 0, 0.7);">
     <div class="bg-gradient-to-b from-yellow-500 to-orange-600 rounded-3xl p-8 text-center shadow-2xl border-8 border-yellow-300 transform transition-transform ultimate-win">
      <div class="text-7xl mb-4">
       ğŸ†
      </div>
      <h2 class="text-6xl font-bangers text-white mb-4 drop-shadow-lg">YOU WIN!</h2>
      <div class="text-4xl font-bold text-white mb-6 drop-shadow-lg"><span id="final-winnings">+$0</span>
      </div><button id="play-again-btn" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white text-2xl font-bold px-8 py-4 rounded-2xl transition-all active:scale-95"> ğŸ° PLAY AGAIN ğŸ° </button>
     </div>
    </div><!-- Title -->
    <h1 id="game-title" class="font-bangers text-5xl md:text-7xl text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-yellow-500 to-orange-500 mb-6 drop-shadow-lg tracking-wider text-center">ğŸ° LUCKY SLOTS ğŸ°</h1><!-- Fake Money Disclaimer -->
    <div class="bg-purple-900/50 text-purple-200 px-4 py-2 rounded-full text-sm mb-4 border border-purple-500/30">
     âœ¨ Play for FUN - All winnings are FAKE MONEY! âœ¨
    </div><!-- Balance Display -->
    <div class="bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl px-8 py-4 mb-6 shadow-xl">
     <div class="text-emerald-100 text-sm uppercase tracking-wider mb-1">
      Your Balance
     </div>
     <div id="balance" class="text-4xl font-bold text-white">
      $1,000
     </div>
    </div><!-- Slot Machine -->
    <div class="slot-machine rounded-3xl p-6 md:p-8 shadow-2xl border-4 border-yellow-500/50 relative"><!-- Decorative lights -->
     <div class="absolute -top-3 left-1/2 -translate-x-1/2 flex gap-2">
      <div class="w-4 h-4 rounded-full bg-red-500 animate-pulse"></div>
      <div class="w-4 h-4 rounded-full bg-yellow-500 animate-pulse" style="animation-delay: 0.2s;"></div>
      <div class="w-4 h-4 rounded-full bg-green-500 animate-pulse" style="animation-delay: 0.4s;"></div>
      <div class="w-4 h-4 rounded-full bg-blue-500 animate-pulse" style="animation-delay: 0.6s;"></div>
      <div class="w-4 h-4 rounded-full bg-purple-500 animate-pulse" style="animation-delay: 0.8s;"></div>
     </div><!-- Reels Display -->
     <div id="reels-display" class="flex gap-3 md:gap-4 bg-gray-900 rounded-2xl p-4 mb-6 border-4 border-gray-700">
      <div class="reel-wrapper bg-white rounded-xl w-20 h-24 md:w-28 md:h-28 flex items-center justify-center shadow-inner border-4 border-gray-300"><span id="reel1" class="text-5xl md:text-6xl">ğŸ’</span>
      </div>
      <div class="reel-wrapper bg-white rounded-xl w-20 h-24 md:w-28 md:h-28 flex items-center justify-center shadow-inner border-4 border-gray-300"><span id="reel2" class="text-5xl md:text-6xl">ğŸ‹</span>
      </div>
      <div class="reel-wrapper bg-white rounded-xl w-20 h-24 md:w-28 md:h-28 flex items-center justify-center shadow-inner border-4 border-gray-300"><span id="reel3" class="text-5xl md:text-6xl">ğŸ‡</span>
      </div>
     </div><!-- Win Display -->
     <div id="win-display" class="text-center mb-6 h-12"><span id="win-text" class="text-2xl font-bold text-yellow-400"></span>
     </div><!-- Spin Counter & Goal -->
     <div class="flex gap-4 justify-center mb-6 w-full px-4">
      <div class="bg-gray-800 rounded-xl px-6 py-3 border-2 border-gray-600 text-center">
       <div class="text-gray-400 text-xs uppercase tracking-wider">
        Spins Left
       </div>
       <div id="spin-counter" class="text-2xl font-bold text-white">
        10
       </div>
      </div>
      <div class="bg-blue-900 rounded-xl px-6 py-3 border-2 border-blue-600 text-center">
       <div class="text-blue-300 text-xs uppercase tracking-wider">
        Goal
       </div>
       <div class="text-2xl font-bold text-blue-200">
        +$1,000
       </div>
      </div>
     </div><!-- Bet Controls -->
     <div class="flex items-center justify-center gap-4 mb-6"><button id="bet-down" class="bg-gray-700 hover:bg-gray-600 text-white w-12 h-12 rounded-full text-2xl font-bold transition-all active:scale-95 border-2 border-gray-500"> âˆ’ </button>
      <div class="bg-gray-800 rounded-xl px-6 py-3 min-w-32 text-center border-2 border-gray-600">
       <div class="text-gray-400 text-xs uppercase tracking-wider">
        Bet
       </div>
       <div id="current-bet" class="text-2xl font-bold text-white">
        $50
       </div>
      </div><button id="bet-up" class="bg-gray-700 hover:bg-gray-600 text-white w-12 h-12 rounded-full text-2xl font-bold transition-all active:scale-95 border-2 border-gray-500"> + </button>
     </div><!-- Spin Button --> <button id="spin-btn" class="w-full bg-gradient-to-r from-red-500 via-red-600 to-red-700 hover:from-red-600 hover:via-red-700 hover:to-red-800 text-white text-2xl font-bold py-5 rounded-2xl shadow-lg transition-all active:scale-98 disabled:opacity-50 disabled:cursor-not-allowed border-b-4 border-red-900"> ğŸ² SPIN TO WIN! ğŸ² </button>
    </div><!-- Paytable -->
    <div class="mt-8 bg-gray-900/80 rounded-2xl p-6 max-w-md w-full border border-gray-700">
     <h2 class="text-xl font-bold text-yellow-400 text-center mb-4">ğŸ’° PAYTABLE ğŸ’°</h2>
     <div class="space-y-2 text-white">
      <div class="flex justify-between items-center py-2 border-b border-gray-700"><span>ğŸ’ğŸ’ğŸ’ Diamond</span> <span class="text-yellow-400 font-bold">10x</span>
      </div>
      <div class="flex justify-between items-center py-2 border-b border-gray-700"><span>7ï¸âƒ£7ï¸âƒ£7ï¸âƒ£ Lucky 7s</span> <span class="text-yellow-400 font-bold">7x</span>
      </div>
      <div class="flex justify-between items-center py-2 border-b border-gray-700"><span>ğŸ’ğŸ’ğŸ’ Cherries</span> <span class="text-yellow-400 font-bold">5x</span>
      </div>
      <div class="flex justify-between items-center py-2 border-b border-gray-700"><span>ğŸ‹ğŸ‹ğŸ‹ Lemons</span> <span class="text-yellow-400 font-bold">3x</span>
      </div>
      <div class="flex justify-between items-center py-2 border-b border-gray-700"><span>ğŸ‡ğŸ‡ğŸ‡ Grapes</span> <span class="text-yellow-400 font-bold">3x</span>
      </div>
      <div class="flex justify-between items-center py-2"><span>Any 2 Match</span> <span class="text-green-400 font-bold">1.5x</span>
      </div>
     </div>
    </div><!-- Reset Button --> <button id="reset-btn" class="mt-6 text-gray-400 hover:text-white text-sm underline transition-colors"> Reset Balance to $1,000 </button>
   </div>
  </div>
  <script>
    const symbols = ['ğŸ’', 'ğŸ‹', 'ğŸ‡', '7ï¸âƒ£', 'ğŸ’', 'â­', 'ğŸ””'];
    const multipliers = {
      'ğŸ’': 10,
      '7ï¸âƒ£': 7,
      'ğŸ’': 5,
      'ğŸ‹': 3,
      'ğŸ‡': 3,
      'â­': 4,
      'ğŸ””': 4
    };
    
    let balance = 1000;
    let currentBet = 50;
    let isSpinning = false;
    const betOptions = [10, 25, 50, 100, 250, 500];
    let betIndex = 2;
    let startingBalance = 1000;
    let spinCount = 0;
    const maxSpins = 10;
    
    const defaultConfig = {
      game_title: 'ğŸ° LUCKY SLOTS ğŸ°',
      currency_symbol: '$',
      primary_color: '#fbbf24',
      secondary_color: '#10b981',
      background_color: '#302b63',
      text_color: '#ffffff',
      accent_color: '#ef4444'
    };
    
    const reel1 = document.getElementById('reel1');
    const reel2 = document.getElementById('reel2');
    const reel3 = document.getElementById('reel3');
    const balanceDisplay = document.getElementById('balance');
    const currentBetDisplay = document.getElementById('current-bet');
    const spinBtn = document.getElementById('spin-btn');
    const betUpBtn = document.getElementById('bet-up');
    const betDownBtn = document.getElementById('bet-down');
    const winText = document.getElementById('win-text');
    const reelsDisplay = document.getElementById('reels-display');
    const resetBtn = document.getElementById('reset-btn');
    const gameTitleEl = document.getElementById('game-title');
    const coinContainer = document.getElementById('coin-container');
    const spinCounter = document.getElementById('spin-counter');
    const winModal = document.getElementById('win-modal');
    const playAgainBtn = document.getElementById('play-again-btn');
    const finalWinningsEl = document.getElementById('final-winnings');
    
    function formatMoney(amount, symbol) {
      const sym = symbol || (window.elementSdk?.config?.currency_symbol || defaultConfig.currency_symbol);
      return sym + amount.toLocaleString();
    }
    
    function updateDisplay() {
      const config = window.elementSdk?.config || defaultConfig;
      balanceDisplay.textContent = formatMoney(balance, config.currency_symbol);
      currentBetDisplay.textContent = formatMoney(currentBet, config.currency_symbol);
      spinCounter.textContent = Math.max(0, maxSpins - spinCount);
      spinBtn.disabled = isSpinning || balance < currentBet || spinCount >= maxSpins;
    }
    
    function getRandomSymbol() {
      return symbols[Math.floor(Math.random() * symbols.length)];
    }
    
    function createCoinExplosion() {
      const coinEmojis = ['ğŸª™', 'ğŸ’°', 'âœ¨', 'â­'];
      for (let i = 0; i < 20; i++) {
        setTimeout(() => {
          const coin = document.createElement('div');
          coin.className = 'coin absolute text-3xl';
          coin.textContent = coinEmojis[Math.floor(Math.random() * coinEmojis.length)];
          coin.style.left = Math.random() * 100 + '%';
          coin.style.top = '40%';
          coin.style.animationDuration = (0.8 + Math.random() * 0.5) + 's';
          coinContainer.appendChild(coin);
          setTimeout(() => coin.remove(), 1500);
        }, i * 50);
      }
    }
    
    function showWinModal() {
      const winnings = balance - startingBalance;
      finalWinningsEl.textContent = formatMoney(winnings);
      winModal.classList.remove('hidden');
      createCoinExplosion();
    }
    
    function resetRound() {
      balance = 1000;
      startingBalance = 1000;
      spinCount = 0;
      winText.textContent = '';
      reelsDisplay.classList.remove('jackpot-glow');
      winModal.classList.add('hidden');
      updateDisplay();
    }
    
    async function spin() {
      if (isSpinning || balance < currentBet || spinCount >= maxSpins) return;
      
      isSpinning = true;
      spinCount++;
      balance -= currentBet;
      winText.textContent = '';
      winText.classList.remove('win-animation');
      reelsDisplay.classList.remove('jackpot-glow');
      updateDisplay();
      
      const finalSymbols = [getRandomSymbol(), getRandomSymbol(), getRandomSymbol()];
      
      const spinDurations = [1000, 1500, 2000];
      const reels = [reel1, reel2, reel3];
      
      const spinPromises = reels.map((reel, index) => {
        return new Promise(resolve => {
          const duration = spinDurations[index];
          const intervalTime = 50;
          let elapsed = 0;
          
          const interval = setInterval(() => {
            reel.textContent = getRandomSymbol();
            elapsed += intervalTime;
            
            if (elapsed >= duration) {
              clearInterval(interval);
              reel.textContent = finalSymbols[index];
              resolve();
            }
          }, intervalTime);
        });
      });
      
      await Promise.all(spinPromises);
      
      const [s1, s2, s3] = finalSymbols;
      let winAmount = 0;
      let winMessage = '';
      
      if (s1 === s2 && s2 === s3) {
        const mult = multipliers[s1] || 2;
        winAmount = currentBet * mult;
        winMessage = `ğŸ‰ JACKPOT! ${s1}${s1}${s1} - ${formatMoney(winAmount)}! ğŸ‰`;
        reelsDisplay.classList.add('jackpot-glow');
        createCoinExplosion();
      } else if (s1 === s2 || s2 === s3 || s1 === s3) {
        winAmount = Math.floor(currentBet * 1.5);
        winMessage = `âœ¨ Nice! 2 Match - ${formatMoney(winAmount)}! âœ¨`;
      }
      
      if (winAmount > 0) {
        balance += winAmount;
        winText.textContent = winMessage;
        winText.classList.add('win-animation');
      } else {
        winText.textContent = 'ğŸ˜¢ Try again!';
      }
      
      isSpinning = false;
      updateDisplay();
      
      // Check if balance drops below $10 or spins reach 0
      setTimeout(() => {
        if (balance < 10 || spinCount >= maxSpins) {
          // Check win condition: 10 spins completed and gained $1,000+
          if (spinCount >= maxSpins) {
            const totalWinnings = balance - startingBalance;
            if (totalWinnings >= 1000) {
              showWinModal();
            } else {
              winText.textContent = 'ğŸ˜¢ Game Over! Resetting...';
              setTimeout(() => {
                resetRound();
              }, 2000);
            }
          } else if (balance < 10) {
            // Auto-reset when out of money
            winText.textContent = 'ğŸ’¸ Out of fake money! Resetting...';
            setTimeout(() => {
              resetRound();
            }, 2000);
          }
        }
      }, 500);
    }
    
    function changeBet(direction) {
      betIndex = Math.max(0, Math.min(betOptions.length - 1, betIndex + direction));
      currentBet = betOptions[betIndex];
      updateDisplay();
    }
    
    spinBtn.addEventListener('click', spin);
    betUpBtn.addEventListener('click', () => changeBet(1));
    betDownBtn.addEventListener('click', () => changeBet(-1));
    resetBtn.addEventListener('click', resetRound);
    playAgainBtn.addEventListener('click', resetRound);
    
    async function onConfigChange(config) {
      const c = { ...defaultConfig, ...config };
      gameTitleEl.textContent = c.game_title;
      updateDisplay();
    }
    
    function mapToCapabilities(config) {
      const c = { ...defaultConfig, ...config };
      return {
        recolorables: [
          {
            get: () => c.background_color,
            set: (val) => window.elementSdk.setConfig({ background_color: val })
          },
          {
            get: () => c.secondary_color,
            set: (val) => window.elementSdk.setConfig({ secondary_color: val })
          },
          {
            get: () => c.text_color,
            set: (val) => window.elementSdk.setConfig({ text_color: val })
          },
          {
            get: () => c.primary_color,
            set: (val) => window.elementSdk.setConfig({ primary_color: val })
          },
          {
            get: () => c.accent_color,
            set: (val) => window.elementSdk.setConfig({ accent_color: val })
          }
        ],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }
    
    function mapToEditPanelValues(config) {
      const c = { ...defaultConfig, ...config };
      return new Map([
        ['game_title', c.game_title],
        ['currency_symbol', c.currency_symbol]
      ]);
    }
    
    window.elementSdk.init({
      defaultConfig,
      onConfigChange,
      mapToCapabilities,
      mapToEditPanelValues
    });
    
    updateDisplay();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cc7866e533f4303',t:'MTc3MDg1MTQ4My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
